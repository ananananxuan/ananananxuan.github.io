---
layout: mypost
title: 深度学习
categories: [深度学习]
extMath: true
---

## 深度学习完整流程

###








## 模型的保存与加载
### 1.保存
```
import torch
import torchvision
vgg16 = torchvision.models.vgg16(pretrained=False)
torch.save(vgg16, 'vgg16.pth') #保存模型结构和参数

torch.save(vgg16.state_dict(), 'vgg16_params.pth') #保存模型参数

```
### 2.加载
```
import torch
import torchvision
model = torch.load("vgg16.pth")


vgg16 = torchvision.models.vgg16(pretrained=False)
model_param = torch.load("vgg16_params.pth") 
vgg16.load_state_dict(model_param)

```
#### 使用Tensorboard
Tensorboard的Summerwrite用来代替直接通过matplotlib来监测模型训练情况
```
from torch.utils.tensorboard import SummaryWriter

writer = SummaryWriter('logs')

for i in range(100):
    writer.add_scalar('y=2x', 2*i, i)
    writer.add_scalar('y=x^2', i**2, i)
    writer.add_scalar('y=x^3', i**3, i)

writer.close()
```
在终端中输入下面的代码即可看到
```
tensorboard --logdir=logs --host=127.0.0.1 --port=8008 
```

在jupyter notebook中打开tensorboard
```
%load_ext tensorboard
%tensorboard --logdir=logs --host=127.0.0.1 --port=8008
```
    

### 用GPU训练模型
第一种方法：  
模型，损失函数，数据可以.cuda()来使用GPU

```
if torch.cuda.is_available():
    model = model.cuda()
    loss_fn = loss_fn.cuda()
    imgs = imgs.cuda()
    labels = labels.cuda()

```
第二种方法：  
```
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model.to(device)
loss_fn.to(device)
imgs.to(device)
labels.to(device)
```

### 模型保存与加载
```
import torch
import torchvision
vgg16 = torchvision.models.vgg16(pretrained=False)
model = model.cuda()
loss_fn = loss_fn.cuda()

```

