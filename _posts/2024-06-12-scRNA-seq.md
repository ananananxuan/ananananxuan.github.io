---
layout: mypost
title: scRNA-seq
categories: [单细胞]
---

单细胞转录组数据分析

学习来源：  
https://www.bilibili.com/video/BV1m34y1i7Vf/?spm_id_from=333.788&vd_source=917336f407022762079ae1d9a0b669fd

以10x数据为例，公司给的原始数据是fastq文件，需要自己通过cell ranger处理生成barcodes.tsv.gz、features.tsv.gz和matrix.mtx.gz这三个文件。
1. barcodes.tsv
内容：每个条形码对应一个单细胞。  
格式：每一行包含一个条形码序列。  

2. features.tsv（或genes.tsv，具体名称取决于10x Genomics软件版本）  
内容：每个基因的标识信息。  
格式：通常包含两列或三列，第一列是基因ID，第二列是基因名称，第三列是基因类型（如果有）。  

3. matrix.mtx  
内容：稀疏矩阵格式的基因表达量数据。  
格式：Matrix Market格式，包含三个部分：  
第一行是头信息，指示矩阵的大小和非零元素数量。  
之后的每一行包含三个数字，分别表示行号（基因），列号（细胞），以及对应的表达量。  

1.pre-processing 数据预处理

①读入数据，创建seurat对象
```
library(Seurat)

# 读取10x Genomics数据
data_dir <- "/path/to/outs/filtered_feature_bc_matrix"
seurat_data <- Read10X(data.dir = data_dir)

# 创建Seurat对象
seurat_object <- CreateSeuratObject(counts = seurat_data)

```
②数据质量控制
```
# 计算线粒体基因的比例
seurat_object[["percent.mt"]] <- PercentageFeatureSet(seurat_object, pattern = "^MT-")

# 可视化质控指标，nFeature_RNA和nCount_RNA分别表示细胞中的基因数和
VlnPlot(seurat_object, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)


# 过滤低质量的细胞
seurat_object <- subset(seurat_object, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)
```






