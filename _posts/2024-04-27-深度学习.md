---
layout: mypost
title: 深度学习
categories: [深度学习]
extMath: true
---

## 模型的保存与加载
### 1.保存
```
import torch
import torchvision
vgg16 = torchvision.models.vgg16(pretrained=False)
torch.save(vgg16, 'vgg16.pth') #保存模型结构和参数

torch.save(vgg16.state_dict(), 'vgg16_params.pth') #保存模型参数

```
### 2.加载
```
import torch
import torchvision
model = torch.load("vgg16.pth")


vgg16 = torchvision.models.vgg16(pretrained=False)
model_param = torch.load("vgg16_params.pth") 
vgg16.load_state_dict(model_param)

```

### 2.保存与加载整个模型
```
import torch
import torchvision

vgg16 = torchvision.models.vgg16(pretrained=True)
torch.save(vgg16, 'vgg16.pth')

model = torch.load('vgg16.pth')
model.eval()

# 保存与加载整个模型

```
### 3.保存整个模型


